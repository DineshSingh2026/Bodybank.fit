<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="theme-color" content="#060606">
<title>Body Audit — Part 2 | BodyBank</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Bebas+Neue&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--black:#060606;--dark2:#060606;--gold:#c8a44e;--goldg:linear-gradient(135deg,#d0b058 0%,#c8a44e 50%,#a68c3e 100%);--cream:#f2ece0;--creamd:#bfb9ab;--muted:#666;--bdr:rgba(200,164,78,0.2)}
*{margin:0;padding:0;box-sizing:border-box}html{overflow-x:hidden}
body{background:var(--black);color:var(--cream);font-family:'Outfit',sans-serif;font-weight:300;line-height:1.6;min-height:100vh;-webkit-font-smoothing:antialiased}
.skip-link{position:absolute;left:-9999px;z-index:99999;padding:14px 24px;background:var(--gold);color:var(--black);font-weight:700;font-size:14px;text-decoration:none;border-radius:0 0 6px 0;transition:left .2s}
.skip-link:focus{left:0;outline:2px solid var(--cream);outline-offset:2px}
.p2-nav{position:fixed;top:0;left:0;right:0;z-index:100;display:flex;align-items:center;padding:12px 24px;padding-left:max(24px,env(safe-area-inset-left));padding-right:max(24px,env(safe-area-inset-right));padding-top:max(12px,env(safe-area-inset-top));background:#060606;border-bottom:1px solid var(--bdr);gap:16px}
.p2-back{display:flex;align-items:center;justify-content:center;width:44px;height:44px;border-radius:50%;border:1.5px solid var(--gold);background:rgba(6,6,6,0.7);color:var(--gold);text-decoration:none;transition:all .3s;flex-shrink:0}
.p2-back:hover{background:rgba(200,164,78,0.2);color:var(--gold)}
.p2-nav-logo{height:40px;width:auto;object-fit:contain;mix-blend-mode:lighten}
.form-submit .spinner{display:inline-block;width:18px;height:18px;border:2px solid rgba(0,0,0,.2);border-top-color:currentColor;border-radius:50%;animation:p2spin .7s linear infinite;margin-right:10px;vertical-align:middle}
@keyframes p2spin{to{transform:rotate(360deg)}}
.form-submit.loading .spinner{display:inline-block}
.form-submit:not(.loading) .spinner{display:none}
.p2-wrap{max-width:560px;margin:0 auto;padding:48px 24px 80px;padding-top:110px;overflow-x:hidden}
.p2-header{text-align:center;margin-bottom:40px}
.p2-logo{height:56px;width:auto;object-fit:contain;mix-blend-mode:lighten;margin-bottom:20px}
.p2-title{font-family:'Bebas Neue',sans-serif;font-size:42px;letter-spacing:2px;color:var(--gold);text-transform:uppercase}
.form-group{margin-bottom:20px;min-width:0}
.form-group label{display:block;font-size:14px;font-weight:600;color:var(--cream);margin-bottom:8px;letter-spacing:.5px}
.form-group label .req{color:#e05050}
.form-input{width:100%;padding:14px 18px;background:rgba(255,255,255,0.05);border:1px solid var(--bdr);border-radius:10px;color:var(--cream);font-family:'Outfit',sans-serif;font-size:16px;transition:border-color .3s;outline:none}
.form-input:focus{border-color:var(--gold)}
.form-input::placeholder{color:var(--muted)}
select.form-input{appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23c8a44e' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 16px center;padding-right:44px}
select.form-input option{background:var(--dark2);color:var(--cream)}
textarea.form-input{resize:vertical;min-height:120px}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px;min-width:0}
.form-submit{width:100%;padding:16px;background:var(--goldg);border:none;border-radius:10px;color:var(--black);font-family:'Outfit',sans-serif;font-weight:700;font-size:16px;letter-spacing:1.5px;text-transform:uppercase;cursor:pointer;transition:all .3s;margin-top:12px}
.form-submit:hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(200,164,78,0.35)}
.form-submit:disabled{opacity:.6;cursor:not-allowed;transform:none}
.form-quote{text-align:center;margin-top:28px;padding:24px 28px;background:rgba(200,164,78,0.08);border:1px solid rgba(200,164,78,0.25);border-radius:14px;font-family:'Cormorant Garamond',serif;font-size:20px;line-height:1.5}
.form-quote .q{color:var(--gold);font-weight:600;font-style:italic}
.form-quote .attr{color:var(--creamd);font-size:14px;font-style:italic;margin-top:8px;display:block}
.p2-skip{text-align:center;margin-top:20px}
.p2-skip a{color:var(--muted);font-size:14px;text-decoration:none;transition:color .2s}
.p2-skip a:hover{color:var(--gold)}
.p2-success{text-align:center;padding:60px 24px}
.p2-success h2{font-family:'Bebas Neue',sans-serif;font-size:36px;letter-spacing:2px;color:var(--gold);margin-bottom:16px}
.p2-success p{color:var(--creamd);font-size:16px;line-height:1.7}
.p2-err{color:#e05050;font-size:13px;margin-top:8px}
.char-count{font-size:12px;color:var(--muted);margin-top:6px;text-align:right}
.char-count.near-limit{color:var(--gold)}
.char-count.at-limit{color:#e05050}
@media(max-width:900px){
  body{font-size:17px;line-height:1.65}
  .p2-title{font-size:48px}
  .form-group label{font-size:15px}
  .form-input{font-size:16px}
  .form-quote{font-size:22px}
  .form-quote .attr{font-size:16px}
  .form-submit{font-size:17px}
  .p2-skip a{font-size:16px}
  .p2-success h2{font-size:40px}
  .p2-success p{font-size:18px}
}
@media(max-width:600px){
  body{font-size:17px}
  .form-row{grid-template-columns:1fr}
  .p2-wrap{padding:32px 16px 60px;padding-bottom:max(60px,env(safe-area-inset-bottom))}
  .p2-title{font-size:40px}
  .form-group label{font-size:15px;margin-bottom:10px}
  .form-input{font-size:16px;padding:16px 18px}
  .form-quote{font-size:20px}
  .form-quote .attr{font-size:15px}
  .form-submit{font-size:17px;padding:18px;min-height:52px}
  .p2-skip a{font-size:16px}
  .p2-success h2{font-size:36px}
  .p2-success p{font-size:17px}
  .p2-err{font-size:15px}
}
</style>
</head>
<body>
<a href="#main" class="skip-link">Skip to main content</a>
<nav class="p2-nav" role="navigation" aria-label="Part 2 form navigation">
  <a href="index.html" class="p2-back" title="Back to home" aria-label="Back to home">&#10094;</a>
  <a href="index.html"><img src="img/logo.png" alt="BodyBank" class="p2-nav-logo" decoding="async"></a>
</nav>
<div class="p2-wrap" id="main" role="main">
  <div id="formSection">
    <div class="p2-header">
      <img src="img/logo-bb.png" alt="Body Bank" class="p2-logo" decoding="async">
      <h1 class="p2-title">Body Audit</h1>
    </div>
    <form id="part2Form" onsubmit="return submitPart2(event)">
      <!-- Personal info at top -->
      <div class="form-group"><label>Name <span class="req">*</span></label><input type="text" class="form-input" placeholder="Enter your full name" name="name" maxlength="200" required><span class="char-count" data-for="name">0 / 200</span></div>
      <div class="form-group"><label>Email <span class="req">*</span></label><input type="email" class="form-input" placeholder="Enter your email" name="email" maxlength="254" required><span class="char-count" data-for="email">0 / 254</span></div>
      <div class="form-group"><label>Mobile Number <span class="req">*</span></label><input type="tel" class="form-input" placeholder="Enter your mobile number" name="mobile" maxlength="20" required><span class="char-count" data-for="mobile">0 / 20</span></div>

      <div class="form-group"><label>Sports History</label><textarea class="form-input p2-textarea" placeholder="Describe your history with sports" name="sports_history" maxlength="2500"></textarea><span class="char-count" data-for="sports_history">0 / 2500</span></div>
      <div class="form-group"><label>Past/Current Injuries</label><textarea class="form-input p2-textarea" placeholder="Describe any past and/or current injuries" name="injuries" maxlength="2500"></textarea><span class="char-count" data-for="injuries">0 / 2500</span></div>
      <div class="form-group"><label>Past/Current Mental Health Issues</label><textarea class="form-input p2-textarea" placeholder="Describe any past and/or current mental health issues" name="mental_health" maxlength="2500"></textarea><span class="char-count" data-for="mental_health">0 / 2500</span></div>
      <div class="form-group"><label>Experience with the gym</label><textarea class="form-input p2-textarea" placeholder="Describe any past and/or current experiences of going to the gym" name="gym_experience" maxlength="2500"></textarea><span class="char-count" data-for="gym_experience">0 / 2500</span></div>
      <div class="form-group"><label>Food choices</label><textarea class="form-input p2-textarea" placeholder="Describe the types of food that you eat on a regular basis (including snacks)." name="food_choices" maxlength="2500"></textarea><span class="char-count" data-for="food_choices">0 / 2500</span></div>
      <div class="form-group"><label>Vices &amp; Addictions</label><textarea class="form-input p2-textarea" placeholder="Describe any vices or addictions you have (smoking, drinking, sugary food, TV, internet, etc.)" name="vices_addictions" maxlength="2500"></textarea><span class="char-count" data-for="vices_addictions">0 / 2500</span></div>
      <div class="form-group"><label>What do you want to achieve?</label><textarea class="form-input p2-textarea" placeholder="Describe your goals (mental/physical well-being, transformation, etc.)" name="goals" maxlength="2500"></textarea><span class="char-count" data-for="goals">0 / 2500</span></div>
      <div class="form-group"><label>What compelled you to start?</label><textarea class="form-input p2-textarea" placeholder="Describe what made you take action to improve your lifestyle." name="what_compelled" maxlength="2500"></textarea><span class="char-count" data-for="what_compelled">0 / 2500</span></div>
      <div class="form-group"><label>Normal Activity Level</label>
        <select class="form-input" name="activity_level">
          <option value="">Please select</option>
          <option value="Sedentary (little to no activity)">Sedentary (little to no activity)</option>
          <option value="Light Activity (Walking, Light exercise)">Light Activity (Walking, Light exercise)</option>
          <option value="Moderate Activity (exercise 3-5 days)">Moderate Activity (exercise 3-5 days)</option>
          <option value="High Activity (exercise 6-7 days)">High Activity (exercise 6-7 days)</option>
        </select>
      </div>

      <p class="form-quote"><span class="q">"As you THINK, so shall you BECOME."</span><span class="attr">— Bruce Lee</span></p>
      <button type="submit" class="form-submit" id="submitBtn"><span class="spinner" aria-hidden="true"></span><span class="btn-text">Submit</span></button>
      <div class="p2-skip"><a href="index.html">Skip &gt;&gt;</a></div>
    </form>
  </div>
  <div id="successSection" style="display:none" class="p2-success">
    <h2>Thank You</h2>
    <p>Your Body Audit (Part 2) has been submitted successfully. We'll be in touch soon.</p>
  </div>
</div>
<script>
(function initCharCounters(){
  var form=document.getElementById('part2Form');
  if(!form)return;
  var inputs=form.querySelectorAll('input[maxlength], textarea[maxlength]');
  inputs.forEach(function(inp){
    var name=inp.getAttribute('name');
    var max=inp.getAttribute('maxlength');
    var counter=form.querySelector('.char-count[data-for="'+name+'"]');
    if(!counter)return;
    function update(){
      var len=inp.value.length;
      counter.textContent=len+' / '+max;
      counter.classList.remove('near-limit','at-limit');
      if(len>=max)counter.classList.add('at-limit');
      else if(len>=max*0.9)counter.classList.add('near-limit');
    }
    inp.addEventListener('input',update);
    inp.addEventListener('change',update);
    update();
  });
})();
async function submitPart2(e) {
  e.preventDefault();
  const form = document.getElementById('part2Form');
  const btn = document.getElementById('submitBtn');
  btn.disabled = true;
  btn.classList.add('loading');
  var txt = btn.querySelector('.btn-text');
  if (txt) txt.textContent = 'Submitting…';
  const errEl = form.querySelector('.p2-err');
  if (errEl) errEl.remove();

  const fd = new FormData(form);
  const body = {
    name: fd.get('name') || '',
    email: fd.get('email') || '',
    mobile: fd.get('mobile') || '',
    sports_history: fd.get('sports_history') || '',
    injuries: fd.get('injuries') || '',
    mental_health: fd.get('mental_health') || '',
    gym_experience: fd.get('gym_experience') || '',
    food_choices: fd.get('food_choices') || '',
    vices_addictions: fd.get('vices_addictions') || '',
    goals: fd.get('goals') || '',
    what_compelled: fd.get('what_compelled') || '',
    activity_level: fd.get('activity_level') || ''
  };

  try {
    const apiUrl = (window.location.origin || '') + '/api/part2';
    const res = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) });
    const ct = res.headers.get('content-type') || '';
    let data;
    if (ct.includes('application/json')) {
      data = await res.json();
    } else {
      const text = await res.text();
      throw new Error('Server returned an invalid response. Please ensure the form is served from the same server as the API (e.g. http://localhost:3000/part2-form.html).');
    }
    if (!res.ok) {
      throw new Error(data.error || 'Submission failed');
    }
    document.getElementById('formSection').style.display = 'none';
    document.getElementById('successSection').style.display = 'block';
  } catch (err) {
    const p = document.createElement('p');
    p.className = 'p2-err';
    p.textContent = err.message || 'Something went wrong. Please try again.';
    form.appendChild(p);
    btn.disabled = false;
    btn.classList.remove('loading');
    var txt = btn.querySelector('.btn-text');
    if (txt) txt.textContent = 'Submit';
  }
}
</script>
</body>
</html>
